# Inherit parent authentication settings
AuthType Basic
AuthName "Management Console"
AuthUserFile /etc/apache2/.htpasswd
Require valid-user

# Protect config and includes directories
<DirectoryMatch "^/(config|includes|logs)/">
    Deny from all
</DirectoryMatch>

# User-specific access controls
<DirectoryMatch "^/joe_rambo/">
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /etc/apache2/.htpasswd
    Require user joe_rambo walt
    
    # Allow .php files
    <Files "*.php">
        Allow from all
        Satisfy any
    </Files>
</DirectoryMatch>

<DirectoryMatch "^/light_on_liberty/">
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /etc/apache2/.htpasswd
    Require user bridgitte walt
    
    # Allow .php files
    <Files "*.php">
        Allow from all
        Satisfy any
    </Files>
</DirectoryMatch>

<DirectoryMatch "^/truthisknowledge/">
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /etc/apache2/.htpasswd
    Require user truthisknowledge walt
    
    # Allow .php files
    <Files "*.php">
        Allow from all
        Satisfy any
    </Files>
</DirectoryMatch>

# Security headers
<IfModule mod_headers.c>
    Header set X-Frame-Options "DENY"
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"
</IfModule>

# Disable directory browsing
Options -Indexes
