# Inherit parent authentication
AuthType Basic
AuthName "Management Console"
AuthUserFile /etc/apache2/.htpasswd
Require valid-user

# Protect config and includes directories
<DirectoryMatch "^/(config|includes|logs)/">
    Deny from all
</DirectoryMatch>

# User-specific directory access
<Directory "/var/www/html/conspyre.tv/management/users/joe_rambo">
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /etc/apache2/.htpasswd
    Require user joe_rambo walt
</Directory>

<Directory "/var/www/html/conspyre.tv/management/users/light_on_liberty">
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /etc/apache2/.htpasswd
    Require user bridgitte walt
</Directory>

<Directory "/var/www/html/conspyre.tv/management/users/truthisknowledge">
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /etc/apache2/.htpasswd
    Require user truthisknowledge walt
</Directory>

# Security headers
<IfModule mod_headers.c>
    Header set X-Frame-Options "DENY"
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"
</IfModule>

# Disable directory browsing
Options -Indexes
